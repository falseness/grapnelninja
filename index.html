<!Doctype html>
<html>
    <head>
        <title>grapnel ninja</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta charset = "UTF-8">
        <style>
            body 
            {
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-color: 0;
            }
        </style>
        <script src = "konva.min.js"></script>
    </head>
    <body>
        <script src = "gameoptions.js"></script>
        
        <script src = "createObjectsByModel/createLineObject.js"></script>
        
        <script src = "collision/circlewithline.js"></script>
        <script src = "collision/linewithline.js"></script>
        
        <script src = "sprites/sprite.js"></script>
        <script src = "sprites/element.js"></script>
        <script src = "sprites/ninja.js"></script>
        <script src = "sprites/grapnel.js"></script>
        <script src = "sprites/create.js"></script>
        <script src = "sprites/obstacle.js"></script>
        <script src = "sprites/enemy.js"></script>
        <script src = "sprites/trampoline.js"></script>
        
        <script src = "physics.js"></script>
        
        <script src = "obstacles/generate.js"></script>
        
        <script src = "enemies/generate.js"></script>
        
        <script src = "trampoline/generate.js"></script>
        
        <script src = "elements/generate.js"></script>
        <script src = "elements/delete.js"></script>
        
        <script src = "moveScreen.js"></script>
        
        <script src = "render/layers.js"></script>
        <script src = "render/draw.js"></script>
        
        <script src = "events.js"></script>
        <div id = "container"></div>
        <script>
            'use strict'
            let stage = new Konva.Stage({
                container: 'container',
                width: width,
                height: height
            })
            
            window.onload = startGame()
            
            
            
            function reStart()
            {
                stage.x(0)
                
                grapnel.x = NaN
                grapnel.y = NaN
                grapnel.speedX = 0
                grapnel.speedY = 0
                grapnel.throwed = false
                
                ninja.x = Math.floor(0.2 * width)
                ninja.y = Math.floor(0.2 * height)
                ninja.speedX = 0
                ninja.speedY = 0
                for (let i = sides.length; i < sprites.length; ++i)
                {
                    sprites[i].object.destroy()
                }
                sprites.splice(sides.length, sprites.length - 2)
                
                scoreText.count = 0
                scoreText.setText('score: ' + scoreText.count)
                layer.scoreText.draw()
                
                deltaX = 0
                obstacles.setX(deltaX)
                enemies.setX(deltaX)
                trampolines.setX(deltaX)
                
                generatePrimaryElements()
                drawElementsFirstTime()
            }
            function startGame()
            {
                Konva.pixelRatio = 1
                
                addLayersToStage()
                addSpritesToLayers()
                
                //drawMechanicsLines()
                drawStaticLayers()
                
                
                generatePrimaryElements()
                
                createEvents()
                
                startDrawAnimations()
                
                
                /*ninjaAnim = new Konva.Animation(function(frame)
                {
                    ninja.move()
                    ninja.collision()
                }, layer.ninja)*/
               // requestAnimationFrame(gameLoop)
            }

            function gameLoop()
            {
                physics()

                
                requestAnimationFrame(gameLoop)
            }
            
            
            
        </script>
    </body>
</html>